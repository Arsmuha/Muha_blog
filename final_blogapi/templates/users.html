{% extends 'base.html' %}
{% block title %}–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ¬∑ MuhaBlog{% endblock %}
{% block content %}
<div class="stack">
  <form class="searchbar" method="get" action="/users">
    <input name="q" value="{{ q }}" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (username/email)" />
    <button class="btn" type="submit">–ò—Å–∫–∞—Ç—å</button>
  </form>

  {% for u in users %}
    <div class="card row">
      <div class="row" style="gap:12px">
        {% if u.avatar_url %}
          <img class="avatar" src="{{ u.avatar_url }}" alt="avatar">
        {% else %}
          <div class="avatar avatar--placeholder">üôÇ</div>
        {% endif %}
        <div>
          <div><strong>{{ u.username }}</strong> <span class="badge">{{ u.role }}</span></div>
          <div class="muted">{{ u.bio or '' }}</div>
        </div>
      </div>
      {% if request.state.is_authenticated and u.id != request.state.user_id|int %}
        <form method="post" action="/users/{{ u.id }}/follow">
          <button class="btn {% if u.id in following %}btn--ghost{% else %}btn--primary{% endif %}" type="submit">
            {% if u.id in following %}–û—Ç–ø–∏—Å–∞—Ç—å—Å—è{% else %}–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è{% endif %}
          </button>
        </form>
      {% endif %}
    </div>
  {% else %}
    {% if q %}
      <div class="muted">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</div>
    {% endif %}
  {% endfor %}
</div>
{% endblock %}
